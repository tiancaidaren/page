<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜çº§äº¤æ˜“æœºå™¨äººæ§åˆ¶é¢æ¿ V4</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --chart-bg: #16213e;
            --text-color: #e0e0e0;
            --primary-color: #0f3460;
            --accent-color: #e94560; /* Attack */
            --success-color: #2ecc71;
            --defense-color: #3498db; /* Defense */
            --border-color: rgba(255, 255, 255, 0.1);
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container { width: 100%; max-width: 950px; }

        .card {
            background-color: var(--primary-color);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
        }

        h1, h2 {
            color: #f1f1f1;
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        h1 { text-align: center; border-bottom: 2px solid var(--accent-color); }
        h2 { font-size: 1.5em; }

        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #ccc; }
        input[type="text"], input[type="password"], select {
            width: 100%;
            padding: 12px;
            background-color: var(--chart-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 1em;
            box-sizing: border-box;
        }

        .btn {
            background-color: var(--accent-color);
            color: white; border: none; padding: 12px 25px; font-size: 1.1em;
            border-radius: 8px; cursor: pointer; transition: all 0.3s;
            display: inline-block; text-align: center; margin-top: 10px;
        }
        .btn:hover { transform: translateY(-2px); }
        .btn-add { background-color: var(--success-color); }
        .btn-add:hover { background-color: #3bed82; }
        .btn-test { background-color: var(--defense-color); }
        .btn-test:hover { background-color: #4aa9e9; }

        .strategy-item {
            border: 1px solid var(--border-color);
            background-color: var(--chart-bg);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        /* Condition Builder Styles */
        .condition-builder {
            background-color: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 15px;
        }
        .condition-row {
            display: grid;
            grid-template-columns: 1fr 1.5fr auto;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .condition-logic {
            font-weight: bold;
            color: var(--defense-color);
            margin: 5px 0;
            padding-left: 10px;
        }
        .btn-remove-condition {
            background: #c0392b; color: white; border: none; border-radius: 50%;
            width: 28px; height: 28px; font-size: 1.2em; cursor: pointer;
            line-height: 28px; text-align: center;
        }
        .condition-actions button {
            background: none; border: 1px dashed var(--border-color);
            color: var(--text-color); padding: 5px 10px;
            cursor: pointer; margin-right: 10px; border-radius: 5px;
        }

        .api-status {
            display: flex; align-items: center; gap: 10px;
            padding: 10px; background-color: var(--chart-bg);
            border-radius: 8px; margin-top: 20px;
        }
        .status-dot { width: 15px; height: 15px; border-radius: 50%; }
        .status-dot.disconnected { background-color: #e74c3c; }
        .status-dot.connected { background-color: #2ecc71; }
        
        small { color: #aaa; font-style: italic; display: block; margin-top: 5px;}
    </style>
</head>
<body>

    <div class="container">
        <h1>é«˜çº§äº¤æ˜“æœºå™¨äººæ§åˆ¶é¢æ¿ V4</h1>

        <!-- Step 1: API Configuration -->
        <div class="card">
            <h2>ğŸ”Œ æ­¥éª¤ä¸€: è¿æ¥äº¤æ˜“æ‰€</h2>
            <div class="form-group">
                <label for="api-key">API Key</label>
                <input type="text" id="api-key" placeholder="è¯·è¾“å…¥æ‚¨çš„API Key">
            </div>
            <div class="form-group">
                <label for="secret-key">Secret Key</label>
                <input type="password" id="secret-key" placeholder="è¯·è¾“å…¥æ‚¨çš„Secret Key">
            </div>
            <button class="btn btn-test" onclick="testApiConnection()">æµ‹è¯•è¿æ¥</button>
            <div class="api-status">
                <div id="status-dot" class="status-dot disconnected"></div>
                <span id="status-text">çŠ¶æ€: æœªè¿æ¥</span>
            </div>
            <small>è¯·ç¡®ä¿å·²åœ¨äº¤æ˜“æ‰€åå°ä¸ºè¯¥API Keyå¼€å¯åˆçº¦äº¤æ˜“æƒé™å’ŒåŒå‘æŒä»“æ¨¡å¼ã€‚</small>
        </div>

        <!-- Step 2: Defense Strategies -->
        <div class="card">
            <h2 style="color: var(--defense-color);">ğŸ›¡ï¸ æ­¥éª¤äºŒ: åˆ›å»ºé˜²å®ˆç­–ç•¥ (å¦‚ä½•ç¦»åœº)</h2>
            <p>å®šä¹‰ç‹¬ç«‹çš„ç¦»åœº/é£æ§è§„åˆ™ã€‚å®ƒä»¬å¯ä»¥è¢«ä¸‹é¢çš„è¿›æ”»ç­–ç•¥è°ƒç”¨ã€‚</p>
            
            <div class="strategy-item">
                <div class="form-group">
                    <label>é˜²å®ˆç­–ç•¥åç§°</label>
                    <input type="text" value="3åˆ†é’Ÿå¤šä¿¡å·æ­¢æŸ">
                </div>
                <div class="form-group">
                    <label>è§¦å‘æ¡ä»¶ç»„ (æ»¡è¶³ä»»ä¸€æ¡ä»¶å³å¯)</label>
                    <div class="condition-builder" id="defense-conditions-1">
                        <!-- Conditions will be added here by JS -->
                    </div>
                    <div class="condition-actions">
                        <button onclick="addCondition('defense-conditions-1', 'æˆ–è€…')">+ æˆ–è€…</button>
                    </div>
                </div>
            </div>
            <button class="btn btn-add">âœš æ·»åŠ æ–°é˜²å®ˆç­–ç•¥</button>
        </div>

        <!-- Step 3: Attack Strategies -->
        <div class="card">
            <h2 style="color: var(--accent-color);">ğŸ“ˆ æ­¥éª¤ä¸‰: åˆ›å»ºè¿›æ”»ç­–ç•¥ (å¦‚ä½•å…¥åœº)</h2>
            <p>åˆ›å»ºå…¥åœºè§„åˆ™ï¼Œå¹¶å…³è”ä¸€ä¸ªé˜²å®ˆç­–ç•¥æ¥ç®¡ç†é£é™©ã€‚</p>

            <div class="strategy-item">
                <div class="form-group">
                    <label>è¿›æ”»ç­–ç•¥åç§°</label>
                    <input type="text" value="1å°æ—¶BOLL+SAR+VOLå…±æŒ¯åšå¤š">
                </div>
                <div class="form-group">
                    <label>è§¦å‘æ¡ä»¶ç»„ (å¿…é¡»æ»¡è¶³æ‰€æœ‰æ¡ä»¶)</label>
                    <div class="condition-builder" id="attack-conditions-1">
                         <!-- Conditions will be added here by JS -->
                    </div>
                    <div class="condition-actions">
                        <button onclick="addCondition('attack-conditions-1', 'å¹¶ä¸”')">+ å¹¶ä¸”</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>ä»“ä½ç®¡ç† (å‡¯åˆ©å…¬å¼)</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <input type="text" placeholder="ç­–ç•¥èƒœç‡ (%) ä¾‹: 60">
                        <input type="text" placeholder="ç­–ç•¥ç›ˆäºæ¯” ä¾‹: 2.5">
                    </div>
                </div>
                <div class="form-group">
                    <label>å…³è”é˜²å®ˆç­–ç•¥ (ç”¨äºå¹³ä»“)</label>
                    <select>
                        <option>3åˆ†é’Ÿå¤šä¿¡å·æ­¢æŸ</option>
                        <option>æ—  (æ‰‹åŠ¨å¹³ä»“)</option>
                    </select>
                </div>
            </div>
            <button class="btn btn-add">âœš æ·»åŠ æ–°è¿›æ”»ç­–ç•¥</button>
        </div>
    </div>
    
    <!-- Hidden Template for Condition Row -->
    <div id="condition-template" style="display: none;">
        <div class="condition-row">
            <select class="indicator-select">
                <option>BOLL (å¸ƒæ—å¸¦)</option>
                <option>SAR (æŠ›ç‰©çº¿)</option>
                <option>VOL (æˆäº¤é‡)</option>
                <option>Kçº¿</option>
            </select>
            <select class="rule-select">
                <!-- Rules will be populated by JS -->
            </select>
            <button class="btn-remove-condition" onclick="this.parentElement.remove()">-</button>
        </div>
    </div>

    <script>
        const rules = {
            'BOLL (å¸ƒæ—å¸¦)': ['æ”¶ç›˜ä»· < ä¸‹è½¨', 'æ”¶ç›˜ä»· > ä¸Šè½¨', 'æ”¶ç›˜ä»· > ä¸­è½¨', 'æ”¶ç›˜ä»· < ä¸­è½¨'],
            'SAR (æŠ›ç‰©çº¿)': ['ä»ä¸Šæ–¹ç¿»è½¬è‡³ä¸‹æ–¹ (ä¹°å…¥ä¿¡å·)', 'ä»ä¸‹æ–¹ç¿»è½¬è‡³ä¸Šæ–¹ (å–å‡ºä¿¡å·)'],
            'VOL (æˆäº¤é‡)': ['æ”¾é‡ (å¤§äºè¿‘æœŸå‡é‡)', 'ç¼©é‡ (å°äºè¿‘æœŸå‡é‡)'],
            'Kçº¿': ['æ”¶ç›˜ä»·ä¸Šæ¶¨', 'æ”¶ç›˜ä»·ä¸‹è·Œ']
        };

        function populateRules(indicatorSelect, ruleSelect) {
            const selectedIndicator = indicatorSelect.value;
            ruleSelect.innerHTML = '';
            rules[selectedIndicator].forEach(rule => {
                const option = document.createElement('option');
                option.value = rule;
                option.textContent = rule;
                ruleSelect.appendChild(option);
            });
        }

        function addCondition(containerId, logic) {
            const container = document.getElementById(containerId);
            
            if (container.children.length > 0) {
                const logicEl = document.createElement('div');
                logicEl.className = 'condition-logic';
                logicEl.textContent = logic;
                container.appendChild(logicEl);
            }

            const template = document.getElementById('condition-template');
            const newRow = template.firstElementChild.cloneNode(true);
            
            const indicatorSelect = newRow.querySelector('.indicator-select');
            const ruleSelect = newRow.querySelector('.rule-select');
            
            indicatorSelect.addEventListener('change', () => populateRules(indicatorSelect, ruleSelect));
            
            container.appendChild(newRow);
            populateRules(indicatorSelect, ruleSelect); // Initial population
        }
        
        function testApiConnection() {
            const dot = document.getElementById('status-dot');
            const text = document.getElementById('status-text');
            text.textContent = 'çŠ¶æ€: æµ‹è¯•ä¸­...';
            dot.className = 'status-dot';
            
            setTimeout(() => {
                // Simulate a 50/50 chance of success
                if (Math.random() > 0.5) {
                    dot.className = 'status-dot connected';
                    text.textContent = 'çŠ¶æ€: è¿æ¥æˆåŠŸ';
                } else {
                    dot.className = 'status-dot disconnected';
                    text.textContent = 'çŠ¶æ€: è¿æ¥å¤±è´¥ (è¯·æ£€æŸ¥API Key)';
                }
            }, 1500);
        }

        // Initialize default conditions for demonstration
        document.addEventListener('DOMContentLoaded', () => {
            // Default Defense Strategy
            addCondition('defense-conditions-1', 'æˆ–è€…');
            document.querySelector('#defense-conditions-1 .indicator-select').value = 'SAR (æŠ›ç‰©çº¿)';
            populateRules(document.querySelector('#defense-conditions-1 .indicator-select'), document.querySelector('#defense-conditions-1 .rule-select'));
            document.querySelector('#defense-conditions-1 .rule-select').value = 'ä»ä¸‹æ–¹ç¿»è½¬è‡³ä¸Šæ–¹ (å–å‡ºä¿¡å·)';
            
            addCondition('defense-conditions-1', 'æˆ–è€…');
            const defenseRows = document.querySelectorAll('#defense-conditions-1 .condition-row');
            const lastDefenseRow = defenseRows[defenseRows.length-1];
            lastDefenseRow.querySelector('.indicator-select').value = 'BOLL (å¸ƒæ—å¸¦)';
            populateRules(lastDefenseRow.querySelector('.indicator-select'), lastDefenseRow.querySelector('.rule-select'));
            lastDefenseRow.querySelector('.rule-select').value = 'æ”¶ç›˜ä»· < ä¸­è½¨';


            // Default Attack Strategy
            addCondition('attack-conditions-1', 'å¹¶ä¸”');
            document.querySelector('#attack-conditions-1 .indicator-select').value = 'BOLL (å¸ƒæ—å¸¦)';
            populateRules(document.querySelector('#attack-conditions-1 .indicator-select'), document.querySelector('#attack-conditions-1 .rule-select'));
            document.querySelector('#attack-conditions-1 .rule-select').value = 'æ”¶ç›˜ä»· < ä¸‹è½¨';

            addCondition('attack-conditions-1', 'å¹¶ä¸”');
            let attackRows = document.querySelectorAll('#attack-conditions-1 .condition-row');
            let lastAttackRow = attackRows[attackRows.length-1];
            lastAttackRow.querySelector('.indicator-select').value = 'SAR (æŠ›ç‰©çº¿)';
            populateRules(lastAttackRow.querySelector('.indicator-select'), lastAttackRow.querySelector('.rule-select'));
            lastAttackRow.querySelector('.rule-select').value = 'ä»ä¸Šæ–¹ç¿»è½¬è‡³ä¸‹æ–¹ (ä¹°å…¥ä¿¡å·)';

            addCondition('attack-conditions-1', 'å¹¶ä¸”');
            attackRows = document.querySelectorAll('#attack-conditions-1 .condition-row');
            lastAttackRow = attackRows[attackRows.length-1];
            lastAttackRow.querySelector('.indicator-select').value = 'VOL (æˆäº¤é‡)';
            populateRules(lastAttackRow.querySelector('.indicator-select'), lastAttackRow.querySelector('.rule-select'));
            lastAttackRow.querySelector('.rule-select').value = 'æ”¾é‡ (å¤§äºè¿‘æœŸå‡é‡)';
        });
    </script>

</body>
</html>
