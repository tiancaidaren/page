<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKX 量化交易系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* 左侧导航栏 */
        .sidebar {
            width: 200px;
            background: #2c3e50;
            color: white;
            padding: 20px 0;
            flex-shrink: 0;
        }

        .logo {
            padding: 0 20px 30px;
            font-size: 20px;
            font-weight: bold;
            border-bottom: 1px solid #34495e;
        }

        .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: background 0.3s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: #34495e;
        }

        .nav-item.active {
            background: #34495e;
            border-left-color: #3498db;
        }

        /* 主内容区 */
        .main-content {
            flex: 1;
            overflow-y: auto;
            background: white;
        }

        /* 右侧日志栏 */
        .info-panel {
            width: 400px;
            background: #ecf0f1;
            padding: 20px;
            overflow-y: auto;
            flex-shrink: 0;
        }

        /* 页面内容 */
        .page {
            display: none;
            padding: 30px;
        }

        .page.active {
            display: block;
        }

        .page-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3498db;
        }

        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
        }

        /* 统计卡片 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card:nth-child(2) {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .stat-card:nth-child(3) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .stat-card:nth-child(4) {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
        }

        .stat-change {
            font-size: 12px;
            margin-top: 5px;
            opacity: 0.8;
        }

        /* 按钮样式 */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-small {
            padding: 5px 12px;
            font-size: 12px;
        }

        /* 策略表格 */
        .strategy-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .strategy-table th,
        .strategy-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .strategy-table th {
            background: #34495e;
            color: white;
            font-weight: 600;
        }

        .strategy-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-running {
            background: #d4edda;
            color: #155724;
        }

        .status-stopped {
            background: #f8d7da;
            color: #721c24;
        }

        .account-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background: #e3f2fd;
            color: #1976d2;
        }

        /* 日志面板 */
        .log-panel {
            height: 100%;
        }

        .log-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .log-container {
            background: white;
            border-radius: 4px;
            padding: 15px;
            height: calc(100% - 40px);
            overflow-y: auto;
        }

        .log-entry {
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            background: #f8f9fa;
            font-size: 13px;
            line-height: 1.6;
            border-left: 3px solid #3498db;
        }

        .log-entry.success {
            border-left-color: #27ae60;
            background: #d4edda;
        }

        .log-entry.warning {
            border-left-color: #f39c12;
            background: #fff3cd;
        }

        .log-entry.error {
            border-left-color: #e74c3c;
            background: #f8d7da;
        }

        .log-time {
            color: #7f8c8d;
            font-size: 11px;
            margin-bottom: 4px;
        }

        .log-strategy {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 3px;
        }

        .log-message {
            color: #555;
        }

        .log-details {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid rgba(0,0,0,0.1);
            font-size: 12px;
            color: #666;
        }

        .log-detail-item {
            display: inline-block;
            margin-right: 15px;
        }

        .log-detail-label {
            color: #7f8c8d;
            margin-right: 4px;
        }

        /* 执行记录表格 */
        .execution-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            margin-top: 20px;
        }

        .execution-table th {
            background: #34495e;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .execution-table td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }

        .execution-table tr:hover {
            background: #f8f9fa;
        }

        .direction-long {
            color: #27ae60;
            font-weight: 600;
        }

        .direction-short {
            color: #e74c3c;
            font-weight: 600;
        }

        .pnl-profit {
            color: #27ae60;
            font-weight: 600;
        }

        .pnl-loss {
            color: #e74c3c;
            font-weight: 600;
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #3498db;
        }

        /* 策略配置区域 */
        .strategy-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .signal-item {
            background: white;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
        }

        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ecf0f1;
        }

        .signal-number {
            font-weight: 600;
            color: #3498db;
        }

        .signal-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .signal-field {
            display: flex;
            flex-direction: column;
        }

        .field-label {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .radio-group {
            display: flex;
            gap: 20px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }

        /* API配置 */
        .api-config {
            max-width: 600px;
        }

        .connection-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 4px;
            display: none;
        }

        .connection-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .connection-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .input-group {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .input-addon {
            padding: 10px;
            background: #ecf0f1;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state-text {
            font-size: 16px;
        }

        /* 筛选栏 */
        .filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .filter-item {
            flex: 1;
        }

        /* 账号管理相关样式 */
        .account-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            position: relative;
        }

        .account-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .account-name {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .account-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .account-info-item {
            display: flex;
            flex-direction: column;
        }

        .account-info-label {
            font-size: 12px;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .account-info-value {
            font-size: 14px;
            font-weight: 600;
            color: #2c3e50;
        }

        .account-actions {
            display: flex;
            gap: 10px;
        }

        .account-status-active {
            color: #27ae60;
            font-weight: 600;
        }

        .account-status-inactive {
            color: #e74c3c;
            font-weight: 600;
        }

        /* 响应式设计 */
        @media (max-width: 1400px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 1024px) {
            .sidebar {
                width: 60px;
            }

            .sidebar .logo,
            .nav-item span {
                display: none;
            }

            .nav-item {
                text-align: center;
                padding: 15px 5px;
            }

            .info-panel {
                width: 300px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .account-info {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                padding: 10px 0;
            }

            .sidebar .logo {
                display: block;
                text-align: center;
                padding: 10px;
            }

            .nav-item {
                display: inline-block;
                width: auto;
                padding: 10px 15px;
            }

            .info-panel {
                width: 100%;
                max-height: 400px;
            }

            .signal-row {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .filter-bar {
                flex-direction: column;
            }

            .account-info {
                grid-template-columns: 1fr;
            }
        }

        /* 复选框组样式 */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            font-size: 14px;
        }

        .checkbox-label input {
            width: auto;
            height: auto;
            margin: 0;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- 左侧导航栏 -->
    <div class="sidebar">
        <div class="logo">OKX 量化</div>
        <div class="nav-item active" onclick="switchPage('dashboard')">
            <span>📊 主页面</span>
        </div>
        <div class="nav-item" onclick="switchPage('executions')">
            <span>📈 执行记录</span>
        </div>
        <div class="nav-item" onclick="switchPage('accounts')">
            <span>👤 账号管理</span>
        </div>
        <div class="nav-item" onclick="switchPage('settings')">
            <span>⚙️ 设置</span>
        </div>
    </div>

    <!-- 主内容区 -->
    <div class="main-content">
        <!-- 主页面 -->
        <div id="dashboard" class="page active">
            <div class="page-header">
                <h1 class="page-title">策略管理</h1>
            </div>

            <!-- 统计数据 -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">今日交易次数</div>
                    <div class="stat-value" id="totalTrades">12</div>
                    <div class="stat-change">较昨日 +3</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">今日盈亏</div>
                    <div class="stat-value" id="totalPnl">+$245.80</div>
                    <div class="stat-change">收益率 +2.46%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">胜率</div>
                    <div class="stat-value" id="winRate">66.7%</div>
                    <div class="stat-change">8胜 4负</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">持仓中</div>
                    <div class="stat-value" id="openPositions">3</div>
                    <div class="stat-change">浮动盈亏 +$45.20</div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="switchPage('strategy-config')">+ 新建策略</button>

            <table class="strategy-table">
                <thead>
                <tr>
                    <th>策略名称</th>
                    <th>关联账号</th>
                    <th>进攻策略状态</th>
                    <th>防守策略状态</th>
                    <th>创建时间</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody id="strategyList">
                <tr>
                    <td>BTC-SAR-突破策略</td>
                    <td><span class="account-badge">主账号</span></td>
                    <td><span class="status-badge status-running">运行中</span></td>
                    <td><span class="status-badge status-stopped">已停止</span></td>
                    <td>2025-10-08 14:30</td>
                    <td>
                        <button class="btn btn-small btn-success" onclick="simulateStrategyTrigger('BTC-SAR-突破策略', 'attack', '主账号')">模拟触发</button>
                        <button class="btn btn-small btn-secondary">编辑</button>
                        <button class="btn btn-small btn-danger">删除</button>
                    </td>
                </tr>
                <tr>
                    <td>ETH-周期极值策略</td>
                    <td><span class="account-badge">备用账号</span></td>
                    <td><span class="status-badge status-running">运行中</span></td>
                    <td><span class="status-badge status-running">运行中</span></td>
                    <td>2025-10-07 09:15</td>
                    <td>
                        <button class="btn btn-small btn-success" onclick="simulateStrategyTrigger('ETH-周期极值策略', 'defense', '备用账号')">模拟触发</button>
                        <button class="btn btn-small btn-secondary">编辑</button>
                        <button class="btn btn-small btn-danger">删除</button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- 执行记录页面 -->
        <div id="executions" class="page">
            <div class="page-header">
                <h1 class="page-title">执行记录</h1>
            </div>

            <!-- 筛选栏 -->
            <div class="filter-bar">
                <div class="filter-item">
                    <label class="form-label">账号筛选</label>
                    <select class="form-select">
                        <option>全部账号</option>
                        <option>主账号</option>
                        <option>备用账号</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="form-label">策略筛选</label>
                    <select class="form-select">
                        <option>全部策略</option>
                        <option>BTC-SAR-突破策略</option>
                        <option>ETH-周期极值策略</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="form-label">交易方向</label>
                    <select class="form-select">
                        <option>全部</option>
                        <option>开多</option>
                        <option>开空</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="form-label">时间范围</label>
                    <select class="form-select">
                        <option>今日</option>
                        <option>近3天</option>
                        <option>近7天</option>
                        <option>近30天</option>
                    </select>
                </div>
            </div>

            <!-- 执行记录表格 -->
            <div style="overflow-x: auto;">
                <table class="execution-table">
                    <thead>
                    <tr>
                        <th>时间</th>
                        <th>账号</th>
                        <th>策略名称</th>
                        <th>策略类型</th>
                        <th>交易对</th>
                        <th>方向</th>
                        <th>数量</th>
                        <th>开仓价格</th>
                        <th>平仓价格</th>
                        <th>盈亏</th>
                        <th>备注</th>
                    </tr>
                    </thead>
                    <tbody id="executionTableBody">
                    <tr>
                        <td>10:24:12</td>
                        <td><span class="account-badge">主账号</span></td>
                        <td>BTC-SAR-突破策略</td>
                        <td>进攻</td>
                        <td>BTC-USDT</td>
                        <td class="direction-long">开多</td>
                        <td>0.05</td>
                        <td>$28,450</td>
                        <td>$28,906</td>
                        <td class="pnl-profit">+$45.30</td>
                        <td>SAR上穿触发</td>
                    </tr>
                    <tr>
                        <td>10:18:35</td>
                        <td><span class="account-badge">备用账号</span></td>
                        <td>ETH-周期极值策略</td>
                        <td>防守</td>
                        <td>ETH-USDT</td>
                        <td class="direction-short">开空</td>
                        <td>2.5</td>
                        <td>$1,845</td>
                        <td>$1,840</td>
                        <td class="pnl-loss">-$12.50</td>
                        <td>止损退出</td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div id="noExecutions" class="empty-state" style="display: none;">
                <div class="empty-state-icon">📊</div>
                <div class="empty-state-text">暂无执行记录</div>
            </div>
        </div>

        <!-- 账号管理页面 -->
        <div id="accounts" class="page">
            <div class="page-header">
                <h1 class="page-title">账号管理</h1>
            </div>

            <button class="btn btn-primary" onclick="showAddAccountForm()" style="margin-bottom: 20px;">+ 添加新账号</button>

            <div id="accountList">
                <!-- 账号卡片 1 -->
                <div class="account-card">
                    <div class="account-header">
                        <div class="account-name">主账号</div>
                        <div class="account-actions">
                            <button class="btn btn-small btn-secondary">编辑</button>
                            <button class="btn btn-small btn-danger">删除</button>
                        </div>
                    </div>
                    <div class="account-info">
                        <div class="account-info-item">
                            <div class="account-info-label">API Key</div>
                            <div class="account-info-value">****-****-****-a1b2</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">状态</div>
                            <div class="account-info-value account-status-active">✓ 已连接</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">创建时间</div>
                            <div class="account-info-value">2025-10-01 10:30</div>
                        </div>
                    </div>
                    <div class="account-info">
                        <div class="account-info-item">
                            <div class="account-info-label">关联策略数</div>
                            <div class="account-info-value">2 个</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">今日交易</div>
                            <div class="account-info-value">8 笔</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">今日盈亏</div>
                            <div class="account-info-value pnl-profit">+$156.20</div>
                        </div>
                    </div>
                </div>

                <!-- 账号卡片 2 -->
                <div class="account-card">
                    <div class="account-header">
                        <div class="account-name">备用账号</div>
                        <div class="account-actions">
                            <button class="btn btn-small btn-secondary">编辑</button>
                            <button class="btn btn-small btn-danger">删除</button>
                        </div>
                    </div>
                    <div class="account-info">
                        <div class="account-info-item">
                            <div class="account-info-label">API Key</div>
                            <div class="account-info-value">****-****-****-c3d4</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">状态</div>
                            <div class="account-info-value account-status-active">✓ 已连接</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">创建时间</div>
                            <div class="account-info-value">2025-10-05 14:20</div>
                        </div>
                    </div>
                    <div class="account-info">
                        <div class="account-info-item">
                            <div class="account-info-label">关联策略数</div>
                            <div class="account-info-value">1 个</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">今日交易</div>
                            <div class="account-info-value">4 笔</div>
                        </div>
                        <div class="account-info-item">
                            <div class="account-info-label">今日盈亏</div>
                            <div class="account-info-value pnl-profit">+$89.60</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 添加账号表单（默认隐藏） -->
            <div id="addAccountForm" style="display: none;">
                <div class="strategy-section">
                    <h2 class="section-title">添加新账号</h2>

                    <div class="form-group">
                        <label class="form-label">账号别名</label>
                        <input type="text" class="form-input" id="newAccountName" placeholder="例如：主账号、备用账号">
                    </div>

                    <div class="form-group">
                        <label class="form-label">API Key</label>
                        <input type="text" class="form-input" id="newAccountApiKey" placeholder="请输入 API Key">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Secret Key</label>
                        <input type="password" class="form-input" id="newAccountSecretKey" placeholder="请输入 Secret Key">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Passphrase</label>
                        <input type="password" class="form-input" id="newAccountPassphrase" placeholder="请输入 Passphrase">
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="testNewAccountConnection()">测试连接</button>
                        <button class="btn btn-success" onclick="saveNewAccount()">保存账号</button>
                        <button class="btn btn-secondary" onclick="hideAddAccountForm()">取消</button>
                    </div>

                    <div id="newAccountStatus" class="connection-status"></div>
                </div>
            </div>
        </div>

        <!-- 策略配置页面 -->
        <div id="strategy-config" class="page">
            <div class="page-header">
                <h1 class="page-title">策略配置</h1>
            </div>

            <div class="form-group">
                <label class="form-label">策略名称</label>
                <input type="text" class="form-input" placeholder="请输入策略名称">
            </div>

            <div class="form-group">
                <label class="form-label">关联账号</label>
                <div id="strategyAccountList" class="checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="strategyAccount" value="主账号">
                        <span>主账号</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" name="strategyAccount" value="备用账号">
                        <span>备用账号</span>
                    </label>
                </div>
            </div>

            <!-- 进攻策略配置 -->
            <div class="strategy-section">
                <h2 class="section-title">🎯 进攻策略配置</h2>

                <div class="form-group">
                    <label class="form-label">K线周期</label>
                    <select class="form-select">
                        <option>1分钟</option>
                        <option>5分钟</option>
                        <option>15分钟</option>
                        <option>30分钟</option>
                        <option>1小时</option>
                        <option>4小时</option>
                        <option>1天</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">信号量组合 (所有条件需同时满足)</label>
                    <div id="attackSignals">
                        <!-- 信号量将通过 JS 动态添加 -->
                    </div>
                    <button class="btn btn-secondary" style="margin-top: 10px;" onclick="addSignal('attackSignals')">+ 添加信号量</button>
                </div>

                <div class="form-group">
                    <label class="form-label">开仓方向</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="attackDirection" value="long" checked>
                            <span>开多</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="attackDirection" value="short">
                            <span>开空</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">仓位管理</label>
                    <select class="form-select" id="attackPositionFormula" onchange="updatePositionParams('attack')">
                        <option value="kelly">凯利公式</option>
                        <option value="fixed-ratio">固定比例</option>
                        <option value="fixed-amount">固定金额</option>
                        <option value="atr">ATR动态仓位</option>
                    </select>
                </div>

                <div class="form-group" id="attackPositionParams">
                    <label class="form-label">仓位参数</label>
                    <div class="signal-row">
                        <div class="signal-field">
                            <span class="field-label">胜率 (0-1)</span>
                            <input type="number" class="form-input" placeholder="例如: 0.6" step="0.01" min="0" max="1">
                        </div>
                        <div class="signal-field">
                            <span class="field-label">盈亏比</span>
                            <input type="number" class="form-input" placeholder="例如: 2" step="0.1" min="0">
                        </div>
                    </div>
                </div>
            </div>

            <!-- 防守策略配置 -->
            <div class="strategy-section">
                <h2 class="section-title">🛡️ 防守策略配置</h2>

                <div class="form-group">
                    <label class="form-label">K线周期</label>
                    <select class="form-select">
                        <option>1分钟</option>
                        <option selected>5分钟</option>
                        <option>15分钟</option>
                        <option>30分钟</option>
                        <option>1小时</option>
                        <option>4小时</option>
                        <option>1天</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">信号量组合 (所有条件需同时满足)</label>
                    <div id="defenseSignals">
                        <!-- 信号量将通过 JS 动态添加 -->
                    </div>
                    <button class="btn btn-secondary" style="margin-top: 10px;" onclick="addSignal('defenseSignals')">+ 添加信号量</button>
                </div>

                <div class="form-group">
                    <label class="form-label">开仓方向</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="defenseDirection" value="long">
                            <span>开多</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="defenseDirection" value="short" checked>
                            <span>开空</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">仓位管理</label>
                    <select class="form-select" id="defensePositionFormula" onchange="updatePositionParams('defense')">
                        <option value="kelly">凯利公式</option>
                        <option value="fixed-ratio">固定比例</option>
                        <option value="fixed-amount">固定金额</option>
                        <option value="atr">ATR动态仓位</option>
                    </select>
                </div>

                <div class="form-group" id="defensePositionParams">
                    <label class="form-label">仓位参数</label>
                    <div class="signal-row">
                        <div class="signal-field">
                            <span class="field-label">胜率 (0-1)</span>
                            <input type="number" class="form-input" placeholder="例如: 0.55" step="0.01" min="0" max="1">
                        </div>
                        <div class="signal-field">
                            <span class="field-label">盈亏比</span>
                            <input type="number" class="form-input" placeholder="例如: 1.5" step="0.1" min="0">
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="saveStrategy()">保存策略</button>
                <button class="btn btn-secondary" onclick="switchPage('dashboard')">取消</button>
            </div>
        </div>

        <!-- 设置页面 -->
        <div id="settings" class="page">
            <div class="page-header">
                <h1 class="page-title">系统设置</h1>
            </div>

            <div class="strategy-section">
                <h2 class="section-title">通用设置</h2>

                <div class="form-group">
                    <label class="form-label">默认账号</label>
                    <select class="form-select">
                        <option>主账号</option>
                        <option>备用账号</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">风险控制</label>
                    <div class="signal-row">
                        <div class="signal-field">
                            <span class="field-label">单日最大交易次数</span>
                            <input type="number" class="form-input" placeholder="例如: 20" min="1">
                        </div>
                        <div class="signal-field">
                            <span class="field-label">单日最大亏损 (USDT)</span>
                            <input type="number" class="form-input" placeholder="例如: 500" min="0">
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-success" onclick="saveSettings()">保存设置</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 右侧日志栏 -->
    <div class="info-panel">
        <div class="log-panel">
            <h3 class="log-title">实时交易日志</h3>
            <div class="log-container" id="logContainer">
                <div class="log-entry success">
                    <div class="log-time">2025-10-09 10:23:45</div>
                    <div class="log-strategy">主账号 · BTC-SAR-突破策略 · 进攻</div>
                    <div class="log-message">✅ 信号触发: SAR上穿 + RSI > 70</div>
                </div>
                <div class="log-entry success">
                    <div class="log-time">2025-10-09 10:23:47</div>
                    <div class="log-strategy">主账号 · BTC-SAR-突破策略 · 进攻</div>
                    <div class="log-message">📊 下单成功</div>
                    <div class="log-details">
                            <span class="log-detail-item">
                                <span class="log-detail-label">交易对:</span>
                                <span>BTC-USDT</span>
                            </span>
                        <span class="log-detail-item">
                                <span class="log-detail-label">方向:</span>
                                <span class="direction-long">开多</span>
                            </span>
                        <span class="log-detail-item">
                                <span class="log-detail-label">数量:</span>
                                <span>0.05 BTC</span>
                            </span>
                    </div>
                </div>
                <div class="log-entry success">
                    <div class="log-time">2025-10-09 10:24:12</div>
                    <div class="log-strategy">主账号 · BTC-SAR-突破策略 · 进攻</div>
                    <div class="log-message">💰 订单成交</div>
                    <div class="log-details">
                            <span class="log-detail-item">
                                <span class="log-detail-label">成交价:</span>
                                <span>$28,450</span>
                            </span>
                        <span class="log-detail-item">
                                <span class="log-detail-label">成交额:</span>
                                <span>$1,422.50</span>
                            </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // 账号数据存储
    let accounts = [
        { name: '主账号', apiKey: '****-****-****-a1b2', status: 'active' },
        { name: '备用账号', apiKey: '****-****-****-c3d4', status: 'active' }
    ];

    // 信号量计数器
    let signalCounters = {
        attackSignals: 0,
        defenseSignals: 0
    };

    // 信号量配置模板
    const signalTemplates = {
        'sar': {
            name: 'SAR (抛物线)',
            fields: [
                { name: 'condition', label: '条件', type: 'select', options: ['价格上穿', '价格下穿'] },
                { name: 'af', label: '加速因子', type: 'number', placeholder: '0.02', step: '0.01' },
                { name: 'maxaf', label: '最大加速因子', type: 'number', placeholder: '0.2', step: '0.01' }
            ]
        },
        'period-high': {
            name: '周期内最高点',
            fields: [
                { name: 'period', label: '时间窗口', type: 'number-unit', placeholder: '24', unit: '小时' },
                { name: 'condition', label: '条件', type: 'select', options: ['价格突破', '价格回落'] }
            ]
        },
        'period-low': {
            name: '周期内最低点',
            fields: [
                { name: 'period', label: '时间窗口', type: 'number-unit', placeholder: '24', unit: '小时' },
                { name: 'condition', label: '条件', type: 'select', options: ['价格突破', '价格回落'] }
            ]
        },
        'macd': {
            name: 'MACD',
            fields: [
                { name: 'condition', label: '条件', type: 'select', options: ['金叉', '死叉', 'DIF上穿0轴', 'DIF下穿0轴'] },
                { name: 'fast', label: '快线周期', type: 'number', placeholder: '12' },
                { name: 'slow', label: '慢线周期', type: 'number', placeholder: '26' },
                { name: 'signal', label: '信号线周期', type: 'number', placeholder: '9' }
            ]
        },
        'rsi': {
            name: 'RSI (相对强弱指标)',
            fields: [
                { name: 'condition', label: '条件', type: 'select', options: ['上穿', '下穿', '大于', '小于'] },
                { name: 'value', label: '阈值', type: 'number', placeholder: '70', min: '0', max: '100' },
                { name: 'period', label: '周期', type: 'number', placeholder: '14' }
            ]
        },
        'ma': {
            name: '移动平均线 (MA)',
            fields: [
                { name: 'type', label: '类型', type: 'select', options: ['简单移动平均(SMA)', '指数移动平均(EMA)'] },
                { name: 'condition', label: '条件', type: 'select', options: ['价格上穿', '价格下穿', '金叉', '死叉'] },
                { name: 'period1', label: '周期1', type: 'number', placeholder: '5' },
                { name: 'period2', label: '周期2 (金叉/死叉)', type: 'number', placeholder: '20' }
            ]
        },
        'bollinger': {
            name: '布林带 (Bollinger Bands)',
            fields: [
                { name: 'condition', label: '条件', type: 'select', options: ['突破上轨', '突破下轨', '回归中轨'] },
                { name: 'period', label: '周期', type: 'number', placeholder: '20' },
                { name: 'std', label: '标准差倍数', type: 'number', placeholder: '2', step: '0.1' }
            ]
        },
        'kdj': {
            name: 'KDJ 指标',
            fields: [
                { name: 'condition', label: '条件', type: 'select', options: ['金叉', '死叉', 'K值上穿', 'K值下穿'] },
                { name: 'value', label: '阈值', type: 'number', placeholder: '80', min: '0', max: '100' },
                { name: 'period', label: '周期', type: 'number', placeholder: '9' }
            ]
        }
    };

    // 页面切换
    function switchPage(pageId) {
        document.querySelectorAll('.page').forEach(page => {
            page.classList.remove('active');
        });

        document.getElementById(pageId).classList.add('active');

        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
        });

        const navItems = document.querySelectorAll('.nav-item');
        if (pageId === 'dashboard') {
            navItems[0].classList.add('active');
        } else if (pageId === 'executions') {
            navItems[1].classList.add('active');
        } else if (pageId === 'accounts') {
            navItems[2].classList.add('active');
        } else if (pageId === 'settings') {
            navItems[3].classList.add('active');
        }
    }

    // 显示添加账号表单
    function showAddAccountForm() {
        document.getElementById('addAccountForm').style.display = 'block';
        document.getElementById('accountList').style.display = 'none';
    }

    // 隐藏添加账号表单
    function hideAddAccountForm() {
        document.getElementById('addAccountForm').style.display = 'none';
        document.getElementById('accountList').style.display = 'block';
        // 清空表单
        document.getElementById('newAccountName').value = '';
        document.getElementById('newAccountApiKey').value = '';
        document.getElementById('newAccountSecretKey').value = '';
        document.getElementById('newAccountPassphrase').value = '';
        document.getElementById('newAccountStatus').style.display = 'none';
    }

    // 测试新账号连接
    function testNewAccountConnection() {
        const statusDiv = document.getElementById('newAccountStatus');
        statusDiv.style.display = 'block';
        statusDiv.className = 'connection-status';
        statusDiv.textContent = '正在测试连接...';

        setTimeout(() => {
            statusDiv.className = 'connection-status success';
            statusDiv.textContent = '✅ 连接成功! API 配置有效';
        }, 1500);
    }

    // 保存新账号
    function saveNewAccount() {
        const name = document.getElementById('newAccountName').value;
        const apiKey = document.getElementById('newAccountApiKey').value;

        if (!name || !apiKey) {
            alert('请填写账号别名和API Key');
            return;
        }

        alert('账号已保存: ' + name);
        hideAddAccountForm();
        addLog('success', '系统', '账号管理', `✅ 新账号已添加: ${name}`);
    }

    // 添加信号量
    function addSignal(containerId) {
        const container = document.getElementById(containerId);
        const signalId = `signal-${containerId}-${++signalCounters[containerId]}`;

        const newSignal = document.createElement('div');
        newSignal.className = 'signal-item';
        newSignal.id = signalId;
        newSignal.innerHTML = `
                <div class="signal-header">
                    <span class="signal-number">信号 #${signalCounters[containerId]}</span>
                    <button class="btn btn-small btn-danger" onclick="this.closest('.signal-item').remove()">删除</button>
                </div>
                <div class="signal-row">
                    <div class="signal-field">
                        <span class="field-label">技术指标</span>
                        <select class="form-select indicator-select" onchange="updateSignalFields('${signalId}', this.value)">
                            <option value="">请选择指标</option>
                            <option value="sar">SAR (抛物线)</option>
                            <option value="period-high">周期内最高点</option>
                            <option value="period-low">周期内最低点</option>
                            <option value="macd">MACD</option>
                            <option value="rsi">RSI (相对强弱指标)</option>
                            <option value="ma">移动平均线 (MA)</option>
                            <option value="bollinger">布林带</option>
                            <option value="kdj">KDJ 指标</option>
                        </select>
                    </div>
                </div>
                <div class="signal-params" id="${signalId}-params">
                    <p style="text-align: center; color: #7f8c8d; padding: 20px;">请先选择技术指标</p>
                </div>
            `;

        container.appendChild(newSignal);
    }

    // 更新信号量字段
    function updateSignalFields(signalId, indicatorType) {
        const paramsContainer = document.getElementById(`${signalId}-params`);

        if (!indicatorType || !signalTemplates[indicatorType]) {
            paramsContainer.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">请先选择技术指标</p>';
            return;
        }

        const template = signalTemplates[indicatorType];
        let html = '';

        for (let i = 0; i < template.fields.length; i += 2) {
            html += '<div class="signal-row">';

            for (let j = i; j < Math.min(i + 2, template.fields.length); j++) {
                const field = template.fields[j];
                html += '<div class="signal-field">';
                html += `<span class="field-label">${field.label}</span>`;

                if (field.type === 'select') {
                    html += '<select class="form-select">';
                    field.options.forEach(opt => {
                        html += `<option>${opt}</option>`;
                    });
                    html += '</select>';
                } else if (field.type === 'number-unit') {
                    html += '<div class="input-group">';
                    html += `<input type="number" class="form-input" placeholder="${field.placeholder}" min="1">`;
                    html += `<span class="input-addon">${field.unit}</span>`;
                    html += '</div>';
                } else if (field.type === 'number') {
                    const attrs = `
                            placeholder="${field.placeholder || ''}"
                            ${field.step ? `step="${field.step}"` : ''}
                            ${field.min ? `min="${field.min}"` : ''}
                            ${field.max ? `max="${field.max}"` : ''}
                        `;
                    html += `<input type="number" class="form-input" ${attrs}>`;
                }

                html += '</div>';
            }

            html += '</div>';
        }

        paramsContainer.innerHTML = html;
    }

    // 更新仓位参数
    function updatePositionParams(type) {
        const selectId = `${type}PositionFormula`;
        const paramsId = `${type}PositionParams`;
        const formula = document.getElementById(selectId).value;
        const container = document.getElementById(paramsId);

        let html = '<label class="form-label">仓位参数</label>';

        switch(formula) {
            case 'kelly':
                html += `
                        <div class="signal-row">
                            <div class="signal-field">
                                <span class="field-label">胜率 (0-1)</span>
                                <input type="number" class="form-input" placeholder="例如: 0.6" step="0.01" min="0" max="1">
                            </div>
                            <div class="signal-field">
                                <span class="field-label">盈亏比</span>
                                <input type="number" class="form-input" placeholder="例如: 2" step="0.1" min="0">
                            </div>
                        </div>
                    `;
                break;
            case 'fixed-ratio':
                html += `
                        <div class="signal-row">
                            <div class="signal-field">
                                <span class="field-label">仓位比例 (%)</span>
                                <input type="number" class="form-input" placeholder="例如: 10" min="0" max="100">
                            </div>
                        </div>
                    `;
                break;
            case 'fixed-amount':
                html += `
                        <div class="signal-row">
                            <div class="signal-field">
                                <span class="field-label">固定金额 (USDT)</span>
                                <input type="number" class="form-input" placeholder="例如: 1000" min="0">
                            </div>
                        </div>
                    `;
                break;
            case 'atr':
                html += `
                        <div class="signal-row">
                            <div class="signal-field">
                                <span class="field-label">ATR 周期</span>
                                <input type="number" class="form-input" placeholder="例如: 14" min="1">
                            </div>
                            <div class="signal-field">
                                <span class="field-label">风险倍数</span>
                                <input type="number" class="form-input" placeholder="例如: 2" step="0.1" min="0">
                            </div>
                        </div>
                    `;
                break;
        }

        container.innerHTML = html;
    }

    // 模拟策略触发
    function simulateStrategyTrigger(strategyName, type, accountName) {
        const typeText = type === 'attack' ? '进攻' : '防守';
        const coin = strategyName.includes('BTC') ? 'BTC' : 'ETH';
        const direction = Math.random() > 0.5 ? 'long' : 'short';
        const directionText = direction === 'long' ? '开多' : '开空';
        const directionClass = direction === 'long' ? 'direction-long' : 'direction-short';
        const openPrice = coin === 'BTC' ? (28000 + Math.random() * 1000).toFixed(2) : (1800 + Math.random() * 100).toFixed(2);
        const closePrice = coin === 'BTC' ?
            (parseFloat(openPrice) + (Math.random() * 1000 - 300)).toFixed(2) :
            (parseFloat(openPrice) + (Math.random() * 50 - 15)).toFixed(2);
        const amount = coin === 'BTC' ? (0.01 + Math.random() * 0.1).toFixed(3) : (1 + Math.random() * 3).toFixed(2);
        const pnl = ((parseFloat(closePrice) - parseFloat(openPrice)) * parseFloat(amount) * (direction === 'long' ? 1 : -1)).toFixed(2);
        const pnlClass = pnl > 0 ? 'pnl-profit' : 'pnl-loss';
        const pnlSign = pnl > 0 ? '+' : '';

        // 添加实时日志
        addLog('success', accountName, strategyName, typeText, `✅ 信号触发: 所有条件满足`);

        setTimeout(() => {
            addLog('success', accountName, strategyName, typeText, `📊 下单成功`, [
                { label: '交易对', value: `${coin}-USDT` },
                { label: '方向', value: directionText, class: directionClass },
                { label: '数量', value: `${amount} ${coin}` }
            ]);
        }, 1000);

        setTimeout(() => {
            addLog('success', accountName, strategyName, typeText, `💰 订单成交`, [
                { label: '成交价', value: `$${openPrice}` },
                { label: '成交额', value: `$${(parseFloat(openPrice) * parseFloat(amount)).toFixed(2)}` }
            ]);

            // 添加执行记录
            addExecutionRecord(accountName, strategyName, typeText, coin, directionText, directionClass, amount, openPrice, closePrice, pnl, pnlClass, pnlSign);
        }, 2000);
    }

    // 添加日志
    function addLog(type, account, strategy, subType, message, details = []) {
        const logContainer = document.getElementById('logContainer');
        const logEntry = document.createElement('div');
        logEntry.className = `log-entry ${type}`;

        const now = new Date();
        const timeStr = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;

        let detailsHtml = '';
        if (details.length > 0) {
            detailsHtml = '<div class="log-details">';
            details.forEach(detail => {
                detailsHtml += `
                        <span class="log-detail-item">
                            <span class="log-detail-label">${detail.label}:</span>
                            <span class="${detail.class || ''}">${detail.value}</span>
                        </span>
                    `;
            });
            detailsHtml += '</div>';
        }

        logEntry.innerHTML = `
                <div class="log-time">${timeStr}</div>
                <div class="log-strategy">${account} · ${strategy}${subType ? ' · ' + subType : ''}</div>
                <div class="log-message">${message}</div>
                ${detailsHtml}
            `;

        logContainer.insertBefore(logEntry, logContainer.firstChild);
    }

    // 添加执行记录
    function addExecutionRecord(account, strategy, type, coin, direction, directionClass, amount, openPrice, closePrice, pnl, pnlClass, pnlSign) {
        const tbody = document.getElementById('executionTableBody');
        const row = document.createElement('tr');

        const now = new Date();
        const timeStr = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;

        const remarks = [
            'SAR上穿触发',
            '突破24H最高点',
            '止盈平仓',
            '止损退出',
            'MACD金叉',
            'RSI超买',
            '布林带突破'
        ];
        const randomRemark = remarks[Math.floor(Math.random() * remarks.length)];

        row.innerHTML = `
                <td>${timeStr}</td>
                <td><span class="account-badge">${account}</span></td>
                <td>${strategy}</td>
                <td>${type}</td>
                <td>${coin}-USDT</td>
                <td class="${directionClass}">${direction}</td>
                <td>${amount}</td>
                <td>$${openPrice}</td>
                <td>$${closePrice}</td>
                <td class="${pnlClass}">${pnlSign}$${pnl}</td>
                <td>${randomRemark}</td>
            `;

        tbody.insertBefore(row, tbody.firstChild);

        // 更新统计数据
        updateStats(parseFloat(pnl));
    }

    // 更新统计数据
    function updateStats(pnl) {
        // 更新交易次数
        const countEl = document.getElementById('totalTrades');
        countEl.textContent = parseInt(countEl.textContent) + 1;

        // 更新盈亏
        const pnlEl = document.getElementById('totalPnl');
        const currentPnl = parseFloat(pnlEl.textContent.replace(/[+$,]/g, ''));
        const newPnl = currentPnl + pnl;
        pnlEl.textContent = (newPnl >= 0 ? '+' : '') + '$' + newPnl.toFixed(2);

        // 更新胜率
        const rows = document.querySelectorAll('#executionTableBody tr');
        let wins = 0;
        rows.forEach(row => {
            const pnlText = row.cells[9].textContent;
            if (pnlText.startsWith('+')) wins++;
        });
        const winRate = ((wins / rows.length) * 100).toFixed(1);
        document.getElementById('winRate').textContent = winRate + '%';
    }

    // 保存策略
    function saveStrategy() {
        const account = document.getElementById('strategyAccount').value;
        alert('策略配置已保存，关联账号: ' + account);
        switchPage('dashboard');
        addLog('success', '系统', '配置', '', '📝 新策略已创建并保存');
    }

    // 保存设置
    function saveSettings() {
        alert('系统设置已保存');
        addLog('success', '系统', '设置', '', '✅ 系统设置已更新');
    }

    // 页面加载时初始化
    window.addEventListener('DOMContentLoaded', function() {
        addSignal('attackSignals');
        addSignal('defenseSignals');
    });
</script>
</body>
</html>

